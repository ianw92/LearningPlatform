<div class='row'>
  <div class='col-12 col-lg-11'>
    <h3><%= @page_title %></h3>
  </div>
  <div class='col-3 col-lg-1'>
    <% if can? :edit, @lecture_module %>
      <%= link_to edit_lecture_module_path(@lecture_module), data: { toggle: 'edit-lecture-module-tooltip'}, title: 'Edit Module' do %>
        <i class="fas fa-pencil-alt"></i>
      <% end %>
      |
    <% end %>
    <% if can? :destroy, @lecture_module %>
      <%= link_to @lecture_module, method: :delete, data: { confirm: 'Are you sure?', toggle: 'delete-lecture-module-tooltip'}, title: 'Delete Module' do %>
        <i class="fas fa-trash-alt"></i>
      <% end %>
    <% end %>
  </div>
</div>


<ul class="nav nav-tabs">
  <li class="nav-item active"><a data-toggle="tab" href="#week1" class="nav-link small active"><h6>Week 1</h6></a></li>
  <% for i in 2..12 do %>
    <li class="nav-item"><a data-toggle="tab" href="#week<%= i %>" class="nav-link small"><h6>Week <%= i %></h6></a></li>
  <% end %>
</ul>

<div class="tab-content">
  <% for i in 1..12 do %>
    <% if i == 1 %>
    <div id="week1" class="tab-pane fade in active show">
    <% else %>
    <div id="week<%= i %>" class="tab-pane fade">
    <% end %>
      <br>
      <% if can? :new, LectureModuleContent.new(week: @weeks[i-1]) %>
        <%= link_to new_lecture_module_content_path(week: @weeks[i-1]), class: 'float-right' do %>
          Add Content to Week <%= i %>
        <% end %>
      <% end %>
      <h3>Week <%= i %></h3>


      <ul class="list-unstyled">
        <% if @weekly_content[i-1].empty? %>
          <li class="list-item">No content exists for Week <%= i %> of this module yet.</li>
        <% else %>
          <%= render partial: "lecture_module_contents/lecture_module_content",
                     as: :lecture_module_content,
                     collection: @weekly_content[i-1],
                     locals: { show_pdf: true,
                               show_youTube: true } %>

          <!-- TODO make this next bit a partial? -->
          <li class="list-item">
            <% if @weeks_with_notes.include? i %>
              <% @notes.each do |note| %>
                <% if note.week_id % 12 == i %>
                  <h3>Notes</h3>
                  <%= render 'notes/add_edit_notes', note: note, user: current_user, lecture_module: @lecture_module, week: @weeks[i-1].id %>

                <% end %>
              <% end %>
            <% else %>
              <h3>Add new note</h3>
              <%= render 'notes/add_edit_notes', note: Note.new, user: current_user, lecture_module: @lecture_module, week: @weeks[i-1].id %>
            <% end %>

          </li>
       <% end %>
      </ul>


    </div>

  <% end %>
</div>

<br>
<hr>
<br>
<p>Any notes that you add to a module will only be visible by you.</p>
